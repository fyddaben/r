function initArrayBuffer(e,r,t,o,i){var n=e.createBuffer();if(!n)return console.log("Failed to create the buffer object"),!1;e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW);var a=e.getAttribLocation(e.program,r);return 0>a?(console.log("Failed to get the storage location of "+r),!1):(e.vertexAttribPointer(a,o,i,!1,0,0),e.enableVertexAttribArray(a),e.bindBuffer(e.ARRAY_BUFFER,null),!0)}function initVertexBuffers(e){var r=new Float32Array([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1]),t=new Float32Array([1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0]),o=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1]),i=new Uint8Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);if(!initArrayBuffer(e,"a_Position",r,3,e.FLOAT))return-1;if(!initArrayBuffer(e,"a_Color",t,3,e.FLOAT))return-1;if(!initArrayBuffer(e,"a_Normal",o,3,e.FLOAT))return-1;var n=e.createBuffer();return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bufferData(e.ELEMENT_ARRAY_BUFFER,i,e.STATIC_DRAW),i.length}function main(){var e=document.getElementById("webgl"),r=getWebGLContext(e);if(!r)return void console.log("Failed to get the rendering context fo WebGl");var t=$("#vsh_tmpl").html(),o=$("#fsh_tmpl").html();if(!initShaders(r,t,o))return void console.log("Failed to initialize shaders");var i=initVertexBuffers(r);if(0>i)return console.log("Failed to create the buffer object"),-1;r.clearColor(0,0,0,1),r.enable(r.DEPTH_TEST);var n=r.getUniformLocation(r.program,"u_MvpMatrix"),a=r.getUniformLocation(r.program,"u_LightColor"),f=r.getUniformLocation(r.program,"u_LightDirection"),l=r.getUniformLocation(r.program,"u_AmbientLight"),u=new Matrix4,A=new Vector3([.5,3,4]);A.normalize(),u.setPerspective(30,1,1,100),u.lookAt(3,3,7,0,0,0,0,1,0),r.uniform3f(a,1,1,1),r.uniform3fv(f,A.elements),r.uniformMatrix4fv(n,!1,u.elements),r.uniform3f(l,.2,.2,.2),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_BYTE,0)}$(function(){main()});